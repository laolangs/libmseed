<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libmseed: Tutorial</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libmseed<span id="projectnumber">&#160;3.0.10</span>
   </div>
   <div id="projectbrief">The miniSEED data format library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">libmseed Documentation</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Tutorial </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#common-usage">Common usage</a><ul><li class="level2"><a href="#reading">Reading miniSEED data</a><ul><li class="level3"><a href="#reading-records">Reading miniSEED records from files</a></li>
<li class="level3"><a href="#reading-tracelists">Reading miniSEED from files into traces lists</a></li>
<li class="level3"><a href="#reading-buffers">Reading miniSEED from memory</a></li>
</ul>
</li>
<li class="level2"><a href="#writing">Writing miniSEED records</a><ul><li class="level3"><a href="#callback">Callback design</a></li>
<li class="level3"><a href="#writing-files">Writing miniSEED data to files</a></li>
<li class="level3"><a href="#creating-records">Creating miniSEED records</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="common-usage"></a>
Common usage</h1>
<p >This page contains a description of basic library usage for the most common usage cases.</p>
<p >Additionally, the <a class="el" href="page-examples.html">Examples</a> page contains full examples for common use cases, which are also included in the 'examples' directory of the source code distribution.</p>
<h2><a class="anchor" id="reading"></a>
Reading miniSEED data</h2>
<p >A common task is to read a file of miniSEED records and perform some action based on the header values or apply some process to the data samples. There are two patterns to support this in the library, one to iterate over the file record-by-record and another to read all data into a collection of continuous series.</p>
<h3><a class="anchor" id="reading-records"></a>
Reading miniSEED records from files</h3>
<p >The <a class="el" href="group__io-functions.html#ga120eaddf0e86963ad6764899b3783cad" title="Read miniSEED records from a file or URL.">ms3_readmsr()</a> routine will open a specified file and return <a class="el" href="group__miniseed-record.html#struct_m_s3_record" title="miniSEED record container">MS3Record</a> structures for each miniSEED record it reads from the file. Called iteratively in a loop, all records are returned in the order discovered.</p>
<p >A code snippet for reading miniSEED from a file record-by-record: <a class="anchor" id="msr3-readmsr-snippet"></a></p><div class="fragment"><div class="line"><span class="keywordtype">int</span> main ()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> *filename = <span class="stringliteral">&quot;datafile.mseed&quot;</span>;</div>
<div class="line">  <a class="code hl_struct" href="group__miniseed-record.html#struct_m_s3_record">MS3Record</a> *msr = NULL;</div>
<div class="line">  uint32_t flags = <a class="code hl_define" href="group__control-flags.html#ga3ef588c484b70c0a186d16f974e1b4bc">MSF_SKIPNOTDATA</a> &amp; <a class="code hl_define" href="group__control-flags.html#ga95033e92e20f803ae8e3daebca1a2b5b">MSF_UNPACKDATA</a>;</div>
<div class="line">  <span class="keywordtype">int</span> verbose    = 0;</div>
<div class="line">  <span class="keywordtype">int</span> retcode;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> ((retcode = <a class="code hl_function" href="group__io-functions.html#ga120eaddf0e86963ad6764899b3783cad">ms3_readmsr</a> (&amp;msr, filename, NULL, NULL, flags, verbose)) == <a class="code hl_define" href="group__return-values.html#ga91727033ca93e4d2b47ecb80243b054d">MS_NOERROR</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">/* Do something with the record here, e.g. print */</span></div>
<div class="line">    <a class="code hl_function" href="group__miniseed-record.html#gaad6b4c5c5194d338f9d89dfe84b44bd9">msr3_print</a> (msr, verbose);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (retcode != <a class="code hl_define" href="group__return-values.html#gaaa6856cc106d8dcd273bdaa7a48082d0">MS_ENDOFFILE</a>)</div>
<div class="line">    <a class="code hl_define" href="group__logging.html#ga2d51fa9deb29995ef93287db5e7b11c4">ms_log</a> (2, <span class="stringliteral">&quot;Cannot read %s: %s\n&quot;</span>, filename, <a class="code hl_function" href="group__utility-functions.html#gac7d8c8a631b2d333da3246610b75f079">ms_errorstr</a> (retcode));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Cleanup memory and close file */</span></div>
<div class="line">  <a class="code hl_function" href="group__io-functions.html#ga120eaddf0e86963ad6764899b3783cad">ms3_readmsr</a> (&amp;msr, NULL, NULL, NULL, flags, verbose);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__control-flags_html_ga3ef588c484b70c0a186d16f974e1b4bc"><div class="ttname"><a href="group__control-flags.html#ga3ef588c484b70c0a186d16f974e1b4bc">MSF_SKIPNOTDATA</a></div><div class="ttdeci">#define MSF_SKIPNOTDATA</div><div class="ttdoc">[Parsing] Skip input that cannot be identified as miniSEED</div><div class="ttdef"><b>Definition:</b> libmseed.h:1345</div></div>
<div class="ttc" id="agroup__control-flags_html_ga95033e92e20f803ae8e3daebca1a2b5b"><div class="ttname"><a href="group__control-flags.html#ga95033e92e20f803ae8e3daebca1a2b5b">MSF_UNPACKDATA</a></div><div class="ttdeci">#define MSF_UNPACKDATA</div><div class="ttdoc">[Parsing] Unpack data samples</div><div class="ttdef"><b>Definition:</b> libmseed.h:1344</div></div>
<div class="ttc" id="agroup__io-functions_html_ga120eaddf0e86963ad6764899b3783cad"><div class="ttname"><a href="group__io-functions.html#ga120eaddf0e86963ad6764899b3783cad">ms3_readmsr</a></div><div class="ttdeci">int ms3_readmsr(MS3Record **ppmsr, const char *mspath, int64_t *fpos, int8_t *last, uint32_t flags, int8_t verbose)</div><div class="ttdoc">Read miniSEED records from a file or URL.</div><div class="ttdef"><b>Definition:</b> fileutils.c:72</div></div>
<div class="ttc" id="agroup__logging_html_ga2d51fa9deb29995ef93287db5e7b11c4"><div class="ttname"><a href="group__logging.html#ga2d51fa9deb29995ef93287db5e7b11c4">ms_log</a></div><div class="ttdeci">#define ms_log(level,...)</div><div class="ttdoc">Wrapper for ms_rlog(), call as ms_log (level, format, ...)</div><div class="ttdef"><b>Definition:</b> libmseed.h:1086</div></div>
<div class="ttc" id="agroup__miniseed-record_html_gaad6b4c5c5194d338f9d89dfe84b44bd9"><div class="ttname"><a href="group__miniseed-record.html#gaad6b4c5c5194d338f9d89dfe84b44bd9">msr3_print</a></div><div class="ttdeci">void msr3_print(MS3Record *msr, int8_t details)</div><div class="ttdoc">Print header values of an MS3Record.</div><div class="ttdef"><b>Definition:</b> msrutils.c:238</div></div>
<div class="ttc" id="agroup__miniseed-record_html_struct_m_s3_record"><div class="ttname"><a href="group__miniseed-record.html#struct_m_s3_record">MS3Record</a></div><div class="ttdoc">miniSEED record container</div><div class="ttdef"><b>Definition:</b> libmseed.h:323</div></div>
<div class="ttc" id="agroup__return-values_html_ga91727033ca93e4d2b47ecb80243b054d"><div class="ttname"><a href="group__return-values.html#ga91727033ca93e4d2b47ecb80243b054d">MS_NOERROR</a></div><div class="ttdeci">#define MS_NOERROR</div><div class="ttdoc">No error.</div><div class="ttdef"><b>Definition:</b> libmseed.h:1327</div></div>
<div class="ttc" id="agroup__return-values_html_gaaa6856cc106d8dcd273bdaa7a48082d0"><div class="ttname"><a href="group__return-values.html#gaaa6856cc106d8dcd273bdaa7a48082d0">MS_ENDOFFILE</a></div><div class="ttdeci">#define MS_ENDOFFILE</div><div class="ttdoc">End of file reached return value.</div><div class="ttdef"><b>Definition:</b> libmseed.h:1326</div></div>
<div class="ttc" id="agroup__utility-functions_html_gac7d8c8a631b2d333da3246610b75f079"><div class="ttname"><a href="group__utility-functions.html#gac7d8c8a631b2d333da3246610b75f079">ms_errorstr</a></div><div class="ttdeci">const char * ms_errorstr(int errorcode)</div><div class="ttdoc">Descriptive string for library Return codes.</div><div class="ttdef"><b>Definition:</b> lookup.c:204</div></div>
</div><!-- fragment --><p >It is important to call <a class="el" href="group__io-functions.html#ga120eaddf0e86963ad6764899b3783cad" title="Read miniSEED records from a file or URL.">ms3_readmsr()</a> for cleanup as illustrated to free memory and close files.</p>
<p >There are more advanced versions of this routine. The <a class="el" href="group__io-functions.html#gac67175755fed41e3e3beed8e27b82da9" title="Read miniSEED records from a file or URL in a thread-safe way.">ms3_readmsr_r()</a> function is a thread-safe version that can be used in threaded programs to read files in parallel. The <a class="el" href="group__io-functions.html#gad4e1882600317031345ae83b44bd48fd" title="Read miniSEED records from a file or URL with optional selection.">ms3_readmsr_selection()</a> function is a thread-safe version that can additionally accept <a class="el" href="group__data-selections.html">Data Selections</a> to efficiently return only selected data.</p>
<h3><a class="anchor" id="reading-tracelists"></a>
Reading miniSEED from files into traces lists</h3>
<p >Another option is to read all miniSEED into a <a class="el" href="group__trace-list.html">Trace List</a> without any handling of records. This is done with ms3_readtraces(), which is very useful for quickly reading data for processing. The data are returned in ordered, continuous segments ready for processing.</p>
<p >A code snippet for reading miniSEED from a file into a <a class="el" href="group__trace-list.html">Trace List</a> : <a class="anchor" id="msr3-readtracelist-snippet"></a></p><div class="fragment"><div class="line"><span class="keywordtype">int</span> main ()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">char</span> *filename1    = <span class="stringliteral">&quot;datafile1.mseed&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> *filename2    = <span class="stringliteral">&quot;datafile2.mseed&quot;</span>;</div>
<div class="line">  <a class="code hl_struct" href="group__trace-list.html#struct_m_s3_trace_list">MS3TraceList</a> *mstl = NULL;</div>
<div class="line">  uint32_t flags     = <a class="code hl_define" href="group__control-flags.html#ga3ef588c484b70c0a186d16f974e1b4bc">MSF_SKIPNOTDATA</a> &amp; <a class="code hl_define" href="group__control-flags.html#ga95033e92e20f803ae8e3daebca1a2b5b">MSF_UNPACKDATA</a>;</div>
<div class="line">  <span class="keywordtype">int</span> verbose        = 0;</div>
<div class="line">  <span class="keywordtype">int</span> retcode;</div>
<div class="line"> </div>
<div class="line">  retcode = <a class="code hl_function" href="group__io-functions.html#gadba1db9680c4e40ea9c680f3eb1b753e">ms3_readtracelist</a> (&amp;mstl, filename1, -1.0, -1.0, 0, flags, verbose);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (retcode != <a class="code hl_define" href="group__return-values.html#ga91727033ca93e4d2b47ecb80243b054d">MS_NOERROR</a>)</div>
<div class="line">    <a class="code hl_define" href="group__logging.html#ga2d51fa9deb29995ef93287db5e7b11c4">ms_log</a> (2, <span class="stringliteral">&quot;Cannot read %s: %s\n&quot;</span>, filename1, <a class="code hl_function" href="group__utility-functions.html#gac7d8c8a631b2d333da3246610b75f079">ms_errorstr</a> (retcode));</div>
<div class="line"> </div>
<div class="line">  retcode = <a class="code hl_function" href="group__io-functions.html#gadba1db9680c4e40ea9c680f3eb1b753e">ms3_readtracelist</a> (&amp;mstl, filename2, -1.0, -1.0, 0, flags, verbose);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (retcode != <a class="code hl_define" href="group__return-values.html#ga91727033ca93e4d2b47ecb80243b054d">MS_NOERROR</a>)</div>
<div class="line">    <a class="code hl_define" href="group__logging.html#ga2d51fa9deb29995ef93287db5e7b11c4">ms_log</a> (2, <span class="stringliteral">&quot;Cannot read %s: %s\n&quot;</span>, filename2, <a class="code hl_function" href="group__utility-functions.html#gac7d8c8a631b2d333da3246610b75f079">ms_errorstr</a> (retcode));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mstl)</div>
<div class="line">  {</div>
<div class="line">    fprintf (stderr, <span class="stringliteral">&quot;Error reading file\\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Do something with the traces here, e.g. print */</span></div>
<div class="line">  <a class="code hl_function" href="group__trace-list.html#gad6999931a86547276deb85b36145ccd6">mstl3_printtracelist</a> (mstl, 0, verbose, 0);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__trace-list.html#ga2a436ab4eb7cd653e52e6760c2f51f20">mstl3_free</a> (&amp;mstl, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__io-functions_html_gadba1db9680c4e40ea9c680f3eb1b753e"><div class="ttname"><a href="group__io-functions.html#gadba1db9680c4e40ea9c680f3eb1b753e">ms3_readtracelist</a></div><div class="ttdeci">int ms3_readtracelist(MS3TraceList **ppmstl, const char *mspath, MS3Tolerance *tolerance, int8_t splitversion, uint32_t flags, int8_t verbose)</div><div class="ttdoc">Read miniSEED from a file into a trace list.</div><div class="ttdef"><b>Definition:</b> fileutils.c:577</div></div>
<div class="ttc" id="agroup__trace-list_html_ga2a436ab4eb7cd653e52e6760c2f51f20"><div class="ttname"><a href="group__trace-list.html#ga2a436ab4eb7cd653e52e6760c2f51f20">mstl3_free</a></div><div class="ttdeci">void mstl3_free(MS3TraceList **ppmstl, int8_t freeprvtptr)</div><div class="ttdoc">Free all memory associated with a MS3TraceList.</div><div class="ttdef"><b>Definition:</b> tracelist.c:79</div></div>
<div class="ttc" id="agroup__trace-list_html_gad6999931a86547276deb85b36145ccd6"><div class="ttname"><a href="group__trace-list.html#gad6999931a86547276deb85b36145ccd6">mstl3_printtracelist</a></div><div class="ttdeci">void mstl3_printtracelist(MS3TraceList *mstl, ms_timeformat_t timeformat, int8_t details, int8_t gaps)</div><div class="ttdoc">Print trace list summary information for a MS3TraceList.</div><div class="ttdef"><b>Definition:</b> tracelist.c:2079</div></div>
<div class="ttc" id="agroup__trace-list_html_struct_m_s3_trace_list"><div class="ttname"><a href="group__trace-list.html#struct_m_s3_trace_list">MS3TraceList</a></div><div class="ttdoc">Container for a collection of continuous trace segment, linkable.</div><div class="ttdef"><b>Definition:</b> libmseed.h:540</div></div>
</div><!-- fragment --><p >There are more advanced versions of this routine. The <a class="el" href="group__io-functions.html#gaed872ce608c4d878b7ad63185a30859c" title="Read miniSEED from a file into a trace list, with time range selection.">ms3_readtracelist_timewin()</a> function allows data to be limited to a specific time range while reading. The <a class="el" href="group__io-functions.html#ga4f447cc856a590286bf01eda71eaa74b" title="Read miniSEED from a file into a trace list, with selection filtering.">ms3_readtracelist_selection()</a> can additionally accept <a class="el" href="group__data-selections.html">Data Selections</a> to efficiently return only selected data.</p>
<h3><a class="anchor" id="reading-buffers"></a>
Reading miniSEED from memory</h3>
<p >If an application is not designed to read miniSEED from files the library provides functions functionality to read data from memory. The <a class="el" href="group__trace-list.html#ga0fc8e37886c7b346929dcede76d686fc" title="Parse miniSEED from a buffer and populate a MS3TraceList.">mstl3_readbuffer()</a> function will read all data from a buffer into a <a class="el" href="group__trace-list.html">Trace List</a>. The low-level functions <a class="el" href="group__miniseed-record.html#gabce57fe1524c0917f8c416571858b7aa" title="Detect miniSEED record in buffer.">ms3_detect()</a> and <a class="el" href="group__miniseed-record.html#ga685b3796656bcf24c2f417c94d3631f6" title="Parse miniSEED from a buffer.">msr3_parse()</a> can be used to detect and parse miniSEED records in memory buffers.</p>
<h2><a class="anchor" id="writing"></a>
Writing miniSEED records</h2>
<p >Another common task is to create miniSEED records. There are two patterns to support this in the library: one is to write data from library containers to files and another to create records and provide them back to the caller in a memory buffer via a callback function.</p>
<h3><a class="anchor" id="callback"></a>
Callback design</h3>
<p >If not writing directly to files, the packing interfaces use a callback design, where the caller specifies a function that will be called for every record that is created. It is the responsibility of the callback function to handle the record before returning. This design allows a program to do whatever is needed with generated miniSEED, i.e. write to files, send over the network, or even injection of more information.</p>
<h3><a class="anchor" id="writing-files"></a>
Writing miniSEED data to files</h3>
<p >The library supports writing miniSEED directly to files from either <a class="el" href="group__miniseed-record.html#struct_m_s3_record" title="miniSEED record container">MS3Record</a> or <a class="el" href="group__trace-list.html#struct_m_s3_trace_list" title="Container for a collection of continuous trace segment, linkable.">MS3TraceList</a> containers using <a class="el" href="group__io-functions.html#gaf2d6e0ee8e0cdc39add72816ca56ce4c" title="Write miniSEED from an MS3Record container to a file.">msr3_writemseed()</a> or <a class="el" href="group__io-functions.html#gaca13b52a989f8e86a1f2c96f0ad853ba" title="Write miniSEED from an MS3TraceList container to a file.">mstl3_writemseed()</a> respectively.</p>
<p >A code snippet for writing miniSEED to a file from an <a class="el" href="group__miniseed-record.html#struct_m_s3_record" title="miniSEED record container">MS3Record</a> using <a class="el" href="group__io-functions.html#gaf2d6e0ee8e0cdc39add72816ca56ce4c" title="Write miniSEED from an MS3Record container to a file.">msr3_writemseed()</a>: <a class="anchor" id="msr3-writemseed-snippet"></a></p><div class="fragment"><div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> packedrecords;</div>
<div class="line">  <span class="keywordtype">int</span> verbose = 0;</div>
<div class="line">  <span class="keywordtype">char</span> *msfile = <span class="stringliteral">&quot;output.mseed&quot;</span>;</div>
<div class="line">  int32_t datasamples[] = {0,1,2,3,4,5,6,7,8,9,10};</div>
<div class="line">  <a class="code hl_struct" href="group__miniseed-record.html#struct_m_s3_record">MS3Record</a> *msr;</div>
<div class="line"> </div>
<div class="line">  msr = <a class="code hl_function" href="group__miniseed-record.html#ga45b12b97428e86249ee371ca0fd61473">msr3_init</a> (NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Populate MS3Record values */</span></div>
<div class="line">  strcpy (msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#ac93add454993eff521bc94900bf40ac1">sid</a>, <span class="stringliteral">&quot;XX_TEXT__B_H_E&quot;</span>);</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a418616cb8cea93ef6e70a88b72f11ab0">formatversion</a> = 3;</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a47d7e72d144305b788d69e3ba859f087">reclen</a> = 512;</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a63ee8e965be55863765c56016873be17">encoding</a> = <a class="code hl_define" href="group__encoding-values.html#ga88038a2002e473c74440f7fae5f0dc74">DE_STEIM2</a>;</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a8ed5d39b9df3bfa9dd953c33d27ac73e">starttime</a> = <a class="code hl_function" href="group__time-related.html#ga5970fa0256338e4964e25941eac6c01e">ms_timestr2nstime</a> (<span class="stringliteral">&quot;2018-12-01T00:00:00.000000000&quot;</span>);</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a7578e312e666fcc80cc07fd324201d4e">samprate</a> = 20.0;</div>
<div class="line"> </div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a1c3a46dfc681da1bf5199b48bf9c55d3">datasamples</a> = datasamples;  <span class="comment">/* pointer to 32-bit integer data samples */</span></div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a7871a3c78d7ecb7c30c6526aa1fd9718">numsamples</a> = 11;</div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a866a8640500756bc031ef7897fc1eeb2">sampletype</a> = <span class="charliteral">&#39;i&#39;</span>;  <span class="comment">/* declare data type to be 32-bit integers */</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Write all data in MS3Record to output file, using MSF_FLUSHDATA flag */</span></div>
<div class="line">  packedrecords = <a class="code hl_function" href="group__io-functions.html#gaf2d6e0ee8e0cdc39add72816ca56ce4c">msr3_writemseed</a> (msr, msfile, 1, <a class="code hl_define" href="group__control-flags.html#gaae2d9bb856575a556a4ac4dd1ce5f8c5">MSF_FLUSHDATA</a>, verbose);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__logging.html#ga2d51fa9deb29995ef93287db5e7b11c4">ms_log</a> (0, <span class="stringliteral">&quot;Wrote %d records to %s\n&quot;</span>, packedrecords, msfile);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Disconnect datasamples pointer, otherwise msr3_free() will attempt to free() it */</span></div>
<div class="line">  msr-&gt;<a class="code hl_variable" href="group__miniseed-record.html#a1c3a46dfc681da1bf5199b48bf9c55d3">datasamples</a> = NULL;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__miniseed-record.html#ga72e0d55e9200bbdda71d157cd8939d4e">msr3_free</a> (&amp;msr);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__control-flags_html_gaae2d9bb856575a556a4ac4dd1ce5f8c5"><div class="ttname"><a href="group__control-flags.html#gaae2d9bb856575a556a4ac4dd1ce5f8c5">MSF_FLUSHDATA</a></div><div class="ttdeci">#define MSF_FLUSHDATA</div><div class="ttdoc">[Packing] Pack all available data even if final record would not be filled</div><div class="ttdef"><b>Definition:</b> libmseed.h:1350</div></div>
<div class="ttc" id="agroup__encoding-values_html_ga88038a2002e473c74440f7fae5f0dc74"><div class="ttname"><a href="group__encoding-values.html#ga88038a2002e473c74440f7fae5f0dc74">DE_STEIM2</a></div><div class="ttdeci">#define DE_STEIM2</div><div class="ttdoc">Steim-2 compressed integers.</div><div class="ttdef"><b>Definition:</b> libmseed.h:1302</div></div>
<div class="ttc" id="agroup__io-functions_html_gaf2d6e0ee8e0cdc39add72816ca56ce4c"><div class="ttname"><a href="group__io-functions.html#gaf2d6e0ee8e0cdc39add72816ca56ce4c">msr3_writemseed</a></div><div class="ttdeci">int64_t msr3_writemseed(MS3Record *msr, const char *mspath, int8_t overwrite, uint32_t flags, int8_t verbose)</div><div class="ttdoc">Write miniSEED from an MS3Record container to a file.</div><div class="ttdef"><b>Definition:</b> fileutils.c:886</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a1c3a46dfc681da1bf5199b48bf9c55d3"><div class="ttname"><a href="group__miniseed-record.html#a1c3a46dfc681da1bf5199b48bf9c55d3">MS3Record::datasamples</a></div><div class="ttdeci">void * datasamples</div><div class="ttdoc">Data samples, numsamples of type sampletype.</div><div class="ttdef"><b>Definition:</b> libmseed.h:343</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a418616cb8cea93ef6e70a88b72f11ab0"><div class="ttname"><a href="group__miniseed-record.html#a418616cb8cea93ef6e70a88b72f11ab0">MS3Record::formatversion</a></div><div class="ttdeci">uint8_t formatversion</div><div class="ttdoc">Format major version.</div><div class="ttdef"><b>Definition:</b> libmseed.h:330</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a47d7e72d144305b788d69e3ba859f087"><div class="ttname"><a href="group__miniseed-record.html#a47d7e72d144305b788d69e3ba859f087">MS3Record::reclen</a></div><div class="ttdeci">int32_t reclen</div><div class="ttdoc">Length of miniSEED record in bytes.</div><div class="ttdef"><b>Definition:</b> libmseed.h:325</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a63ee8e965be55863765c56016873be17"><div class="ttname"><a href="group__miniseed-record.html#a63ee8e965be55863765c56016873be17">MS3Record::encoding</a></div><div class="ttdeci">int8_t encoding</div><div class="ttdoc">Data encoding format, see Data Encodings.</div><div class="ttdef"><b>Definition:</b> libmseed.h:334</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a7578e312e666fcc80cc07fd324201d4e"><div class="ttname"><a href="group__miniseed-record.html#a7578e312e666fcc80cc07fd324201d4e">MS3Record::samprate</a></div><div class="ttdeci">double samprate</div><div class="ttdoc">Nominal sample rate as samples/second (Hz) or period (s)</div><div class="ttdef"><b>Definition:</b> libmseed.h:333</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a7871a3c78d7ecb7c30c6526aa1fd9718"><div class="ttname"><a href="group__miniseed-record.html#a7871a3c78d7ecb7c30c6526aa1fd9718">MS3Record::numsamples</a></div><div class="ttdeci">int64_t numsamples</div><div class="ttdoc">Number of data samples in datasamples.</div><div class="ttdef"><b>Definition:</b> libmseed.h:345</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a866a8640500756bc031ef7897fc1eeb2"><div class="ttname"><a href="group__miniseed-record.html#a866a8640500756bc031ef7897fc1eeb2">MS3Record::sampletype</a></div><div class="ttdeci">char sampletype</div><div class="ttdoc">Sample type code: a, i, f, d Sample Types.</div><div class="ttdef"><b>Definition:</b> libmseed.h:346</div></div>
<div class="ttc" id="agroup__miniseed-record_html_a8ed5d39b9df3bfa9dd953c33d27ac73e"><div class="ttname"><a href="group__miniseed-record.html#a8ed5d39b9df3bfa9dd953c33d27ac73e">MS3Record::starttime</a></div><div class="ttdeci">nstime_t starttime</div><div class="ttdoc">Record start time (first sample)</div><div class="ttdef"><b>Definition:</b> libmseed.h:332</div></div>
<div class="ttc" id="agroup__miniseed-record_html_ac93add454993eff521bc94900bf40ac1"><div class="ttname"><a href="group__miniseed-record.html#ac93add454993eff521bc94900bf40ac1">MS3Record::sid</a></div><div class="ttdeci">char sid[LM_SIDLEN]</div><div class="ttdoc">Source identifier as URN, max length LM_SIDLEN.</div><div class="ttdef"><b>Definition:</b> libmseed.h:329</div></div>
<div class="ttc" id="agroup__miniseed-record_html_ga45b12b97428e86249ee371ca0fd61473"><div class="ttname"><a href="group__miniseed-record.html#ga45b12b97428e86249ee371ca0fd61473">msr3_init</a></div><div class="ttdeci">MS3Record * msr3_init(MS3Record *msr)</div><div class="ttdoc">Initialize and return an MS3Record.</div><div class="ttdef"><b>Definition:</b> msrutils.c:44</div></div>
<div class="ttc" id="agroup__miniseed-record_html_ga72e0d55e9200bbdda71d157cd8939d4e"><div class="ttname"><a href="group__miniseed-record.html#ga72e0d55e9200bbdda71d157cd8939d4e">msr3_free</a></div><div class="ttdeci">void msr3_free(MS3Record **ppmsr)</div><div class="ttdoc">Free all memory associated with a MS3Record.</div><div class="ttdef"><b>Definition:</b> msrutils.c:89</div></div>
<div class="ttc" id="agroup__time-related_html_ga5970fa0256338e4964e25941eac6c01e"><div class="ttname"><a href="group__time-related.html#ga5970fa0256338e4964e25941eac6c01e">ms_timestr2nstime</a></div><div class="ttdeci">nstime_t ms_timestr2nstime(const char *timestr)</div><div class="ttdoc">Convert a time string to a high precision epoch time.</div><div class="ttdef"><b>Definition:</b> genutils.c:1218</div></div>
</div><!-- fragment --><h3><a class="anchor" id="creating-records"></a>
Creating miniSEED records</h3>
<p >Records can be generated from data in either <a class="el" href="group__miniseed-record.html#struct_m_s3_record" title="miniSEED record container">MS3Record</a> or <a class="el" href="group__trace-list.html#struct_m_s3_trace_list" title="Container for a collection of continuous trace segment, linkable.">MS3TraceList</a> containers using, respectively, <a class="el" href="group__miniseed-record.html#gaa649330804f08b4d4cef9c0b1d8f7867" title="Pack data into miniSEED records.">msr3_pack()</a> or and <a class="el" href="group__trace-list.html#ga28697b648a1390ae480fdcf75a478079" title="Pack MS3TraceList data into miniSEED records.">mstl3_pack()</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- GitHub corner from https://github.com/tholman/github-corners -->
<a href="https://github.com/iris-edu/libmseed" class="github-corner" aria-label="View source on GitHub"><svg width="75" height="75" viewBox="0 0 250 250" style="fill:#442487; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<a href="https://ds.iris.edu"><img style="position: absolute; top: 0; border: 0; right: 75px; height:75px;" src="https://www.iris.edu/hq/files/publications/logos/iris_color_screen.png"></a>
